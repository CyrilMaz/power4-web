<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Puissance 4 - Mode Pouvoirs</title>
  <link rel="stylesheet" href="/static/style.css">
  <script src="/static/script.js" defer></script>
</head>
<body>
  <h1>Puissance 4 Mode Pouvoirs</h1>

  {{if eq .Winner 0}}
    <p id="status">Tour du joueur {{.Current}} {{if eq .Current 1}}ğŸ”´{{else}}ğŸŸ¡{{end}}</p>
  {{else}}
    <p id="status">Joueur {{.Winner}} a gagnÃ© !</p>
  {{end}}

  {{if eq .Winner 0}}
    <div class="powers-container">
      <h3>Pouvoirs disponibles :</h3>
      <div class="powers-list">
        {{$powers := index .Powers .Current}}
        {{range $powers}}
          <button class="power-btn {{if eq .Uses 0}}disabled{{end}}" 
                  data-power="{{.Name}}"
                  {{if eq .Uses 0}}disabled{{end}}>
            {if eq .Name "destroy"}{{else if eq .Name "swap"}}ğŸ”„{{else if eq .Name "block"}}ğŸš«{{end}} 
            {{.Name}}
            <span class="power-uses">({{.Uses}}/{{.MaxUses}})</span>
          </button>
        {{end}}
      </div>
      <p id="power-instruction" class="instruction hidden">Cliquez sur une case pour utiliser le pouvoir</p>
    </div>
  {{end}}

  <div id="board" class="board">
    {{range $r, $row := .Board}}
      {{range $c, $cell := $row}}
        <a href="/play?col={{$c}}"
           class="cell
                  {{if eq $cell 1}}player1{{else if eq $cell 2}}player2{{else if eq $cell 3}}blocked{{end}}
                  {{if and (eq $.LastRow $r) (eq $.LastCol $c)}}lastMove{{end}}
                  {{if isWinning $.WinningCells $r $c}}winning{{end}}"
           data-row="{{$r}}"
           data-col="{{$c}}">
        </a>
      {{end}}
    {{end}}
  </div>

  <form action="/reset" method="get">
    <button type="submit">Recommencer</button>
  </form>

  <div class="help-section">
    <h3>ğŸ“– Guide des pouvoirs :</h3>
    <ul>
      <li> <strong>Destroy</strong> : DÃ©truit une piÃ¨ce adverse (la gravitÃ© s'applique)</li>
      <li> <strong>Swap</strong> : Ã‰change deux piÃ¨ces verticalement adjacentes</li>
      <li> <strong>Block</strong> : Bloque une colonne avec une piÃ¨ce neutre</li>
    </ul>
  </div>
</body>
</html>